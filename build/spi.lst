ARM GAS  /tmp/cc2NIaC5.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"spi.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.spi_init,"ax",%progbits
  16              		.align	1
  17              		.global	spi_init
  18              		.arch armv7-m
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu softvfp
  24              	spi_init:
  25              	.LVL0:
  26              	.LFB70:
  27              		.file 1 "./src/spi.c"
   1:./src/spi.c   **** #include "spi.h"
   2:./src/spi.c   **** #include <string.h>
   3:./src/spi.c   **** 
   4:./src/spi.c   **** static osMutexId spi_mutex;
   5:./src/spi.c   **** osMutexDef(spi_mutex);
   6:./src/spi.c   **** 
   7:./src/spi.c   **** void spi_init(spi_t *spi)
   8:./src/spi.c   **** {
  28              		.loc 1 8 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		.loc 1 8 1 is_stmt 0 view .LVU1
  33 0000 10B5     		push	{r4, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 4, -8
  37              		.cfi_offset 14, -4
  38 0002 0446     		mov	r4, r0
   9:./src/spi.c   ****     spi->mutex = osMutexCreate(osMutex(spi_mutex)); 
  39              		.loc 1 9 5 is_stmt 1 view .LVU2
  40              		.loc 1 9 18 is_stmt 0 view .LVU3
  41 0004 0248     		ldr	r0, .L3
  42              	.LVL1:
  43              		.loc 1 9 18 view .LVU4
  44 0006 FFF7FEFF 		bl	osMutexCreate
  45              	.LVL2:
  46              		.loc 1 9 16 view .LVU5
  47 000a 2060     		str	r0, [r4]
  10:./src/spi.c   **** }
  48              		.loc 1 10 1 view .LVU6
ARM GAS  /tmp/cc2NIaC5.s 			page 2


  49 000c 10BD     		pop	{r4, pc}
  50              	.LVL3:
  51              	.L4:
  52              		.loc 1 10 1 view .LVU7
  53 000e 00BF     		.align	2
  54              	.L3:
  55 0010 00000000 		.word	.LANCHOR0
  56              		.cfi_endproc
  57              	.LFE70:
  59              		.section	.text.spi_ss_on,"ax",%progbits
  60              		.align	1
  61              		.global	spi_ss_on
  62              		.syntax unified
  63              		.thumb
  64              		.thumb_func
  65              		.fpu softvfp
  67              	spi_ss_on:
  68              	.LVL4:
  69              	.LFB71:
  11:./src/spi.c   **** 
  12:./src/spi.c   **** void spi_ss_on(gpio_t *pin)
  13:./src/spi.c   **** {
  70              		.loc 1 13 1 is_stmt 1 view -0
  71              		.cfi_startproc
  72              		@ args = 0, pretend = 0, frame = 0
  73              		@ frame_needed = 0, uses_anonymous_args = 0
  74              		.loc 1 13 1 is_stmt 0 view .LVU9
  75 0000 08B5     		push	{r3, lr}
  76              	.LCFI1:
  77              		.cfi_def_cfa_offset 8
  78              		.cfi_offset 3, -8
  79              		.cfi_offset 14, -4
  14:./src/spi.c   ****     gpio_set(pin);
  80              		.loc 1 14 5 is_stmt 1 view .LVU10
  81 0002 FFF7FEFF 		bl	gpio_set
  82              	.LVL5:
  15:./src/spi.c   **** }
  83              		.loc 1 15 1 is_stmt 0 view .LVU11
  84 0006 08BD     		pop	{r3, pc}
  85              		.cfi_endproc
  86              	.LFE71:
  88              		.section	.text.spi_ss_off,"ax",%progbits
  89              		.align	1
  90              		.global	spi_ss_off
  91              		.syntax unified
  92              		.thumb
  93              		.thumb_func
  94              		.fpu softvfp
  96              	spi_ss_off:
  97              	.LVL6:
  98              	.LFB72:
  16:./src/spi.c   **** 
  17:./src/spi.c   **** void spi_ss_off(gpio_t *pin)
  18:./src/spi.c   **** {
  99              		.loc 1 18 1 is_stmt 1 view -0
 100              		.cfi_startproc
 101              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/cc2NIaC5.s 			page 3


 102              		@ frame_needed = 0, uses_anonymous_args = 0
 103              		.loc 1 18 1 is_stmt 0 view .LVU13
 104 0000 08B5     		push	{r3, lr}
 105              	.LCFI2:
 106              		.cfi_def_cfa_offset 8
 107              		.cfi_offset 3, -8
 108              		.cfi_offset 14, -4
  19:./src/spi.c   ****     gpio_reset(pin);
 109              		.loc 1 19 5 is_stmt 1 view .LVU14
 110 0002 FFF7FEFF 		bl	gpio_reset
 111              	.LVL7:
  20:./src/spi.c   **** }
 112              		.loc 1 20 1 is_stmt 0 view .LVU15
 113 0006 08BD     		pop	{r3, pc}
 114              		.cfi_endproc
 115              	.LFE72:
 117              		.section	.text.spi_read,"ax",%progbits
 118              		.align	1
 119              		.global	spi_read
 120              		.syntax unified
 121              		.thumb
 122              		.thumb_func
 123              		.fpu softvfp
 125              	spi_read:
 126              	.LVL8:
 127              	.LFB73:
  21:./src/spi.c   **** 
  22:./src/spi.c   **** void spi_read(spi_t *spi, uint8_t *data, uint16_t len)
  23:./src/spi.c   **** {
 128              		.loc 1 23 1 is_stmt 1 view -0
 129              		.cfi_startproc
 130              		@ args = 0, pretend = 0, frame = 0
 131              		@ frame_needed = 0, uses_anonymous_args = 0
 132              		.loc 1 23 1 is_stmt 0 view .LVU17
 133 0000 70B5     		push	{r4, r5, r6, lr}
 134              	.LCFI3:
 135              		.cfi_def_cfa_offset 16
 136              		.cfi_offset 4, -16
 137              		.cfi_offset 5, -12
 138              		.cfi_offset 6, -8
 139              		.cfi_offset 14, -4
 140 0002 0446     		mov	r4, r0
 141 0004 0D46     		mov	r5, r1
 142 0006 1646     		mov	r6, r2
  24:./src/spi.c   ****     memset(data, 0, len);
 143              		.loc 1 24 5 is_stmt 1 view .LVU18
 144 0008 0021     		movs	r1, #0
 145              	.LVL9:
 146              		.loc 1 24 5 is_stmt 0 view .LVU19
 147 000a 2846     		mov	r0, r5
 148              	.LVL10:
 149              		.loc 1 24 5 view .LVU20
 150 000c FFF7FEFF 		bl	memset
 151              	.LVL11:
  25:./src/spi.c   ****     osMutexWait(spi->mutex, osWaitForever);
 152              		.loc 1 25 5 is_stmt 1 view .LVU21
 153 0010 4FF0FF31 		mov	r1, #-1
ARM GAS  /tmp/cc2NIaC5.s 			page 4


 154 0014 2068     		ldr	r0, [r4]
 155 0016 FFF7FEFF 		bl	osMutexWait
 156              	.LVL12:
  26:./src/spi.c   ****     HAL_SPI_Receive(spi->hspi, data, len, 100);
 157              		.loc 1 26 5 view .LVU22
 158 001a 6423     		movs	r3, #100
 159 001c 3246     		mov	r2, r6
 160 001e 2946     		mov	r1, r5
 161 0020 6068     		ldr	r0, [r4, #4]
 162 0022 FFF7FEFF 		bl	HAL_SPI_Receive
 163              	.LVL13:
  27:./src/spi.c   ****     osMutexRelease(spi->mutex);
 164              		.loc 1 27 5 view .LVU23
 165 0026 2068     		ldr	r0, [r4]
 166 0028 FFF7FEFF 		bl	osMutexRelease
 167              	.LVL14:
  28:./src/spi.c   **** }
 168              		.loc 1 28 1 is_stmt 0 view .LVU24
 169 002c 70BD     		pop	{r4, r5, r6, pc}
 170              		.loc 1 28 1 view .LVU25
 171              		.cfi_endproc
 172              	.LFE73:
 174              		.section	.text.spi_write,"ax",%progbits
 175              		.align	1
 176              		.global	spi_write
 177              		.syntax unified
 178              		.thumb
 179              		.thumb_func
 180              		.fpu softvfp
 182              	spi_write:
 183              	.LVL15:
 184              	.LFB74:
  29:./src/spi.c   **** 
  30:./src/spi.c   **** void spi_write(spi_t *spi, uint8_t *data, uint16_t len)
  31:./src/spi.c   **** {
 185              		.loc 1 31 1 is_stmt 1 view -0
 186              		.cfi_startproc
 187              		@ args = 0, pretend = 0, frame = 0
 188              		@ frame_needed = 0, uses_anonymous_args = 0
 189              		.loc 1 31 1 is_stmt 0 view .LVU27
 190 0000 70B5     		push	{r4, r5, r6, lr}
 191              	.LCFI4:
 192              		.cfi_def_cfa_offset 16
 193              		.cfi_offset 4, -16
 194              		.cfi_offset 5, -12
 195              		.cfi_offset 6, -8
 196              		.cfi_offset 14, -4
 197 0002 0446     		mov	r4, r0
 198 0004 0D46     		mov	r5, r1
 199 0006 1646     		mov	r6, r2
  32:./src/spi.c   ****     osMutexWait(spi->mutex, osWaitForever);
 200              		.loc 1 32 5 is_stmt 1 view .LVU28
 201 0008 4FF0FF31 		mov	r1, #-1
 202              	.LVL16:
 203              		.loc 1 32 5 is_stmt 0 view .LVU29
 204 000c 0068     		ldr	r0, [r0]
 205              	.LVL17:
ARM GAS  /tmp/cc2NIaC5.s 			page 5


 206              		.loc 1 32 5 view .LVU30
 207 000e FFF7FEFF 		bl	osMutexWait
 208              	.LVL18:
  33:./src/spi.c   **** 	HAL_SPI_Transmit(spi->hspi, data, len, 100);
 209              		.loc 1 33 2 is_stmt 1 view .LVU31
 210 0012 6423     		movs	r3, #100
 211 0014 3246     		mov	r2, r6
 212 0016 2946     		mov	r1, r5
 213 0018 6068     		ldr	r0, [r4, #4]
 214 001a FFF7FEFF 		bl	HAL_SPI_Transmit
 215              	.LVL19:
  34:./src/spi.c   ****     osMutexRelease(spi->mutex);
 216              		.loc 1 34 5 view .LVU32
 217 001e 2068     		ldr	r0, [r4]
 218 0020 FFF7FEFF 		bl	osMutexRelease
 219              	.LVL20:
  35:./src/spi.c   **** }
 220              		.loc 1 35 1 is_stmt 0 view .LVU33
 221 0024 70BD     		pop	{r4, r5, r6, pc}
 222              		.loc 1 35 1 view .LVU34
 223              		.cfi_endproc
 224              	.LFE74:
 226              		.global	os_mutex_def_spi_mutex
 227              		.section	.rodata.os_mutex_def_spi_mutex,"a"
 228              		.align	2
 229              		.set	.LANCHOR0,. + 0
 232              	os_mutex_def_spi_mutex:
 233 0000 00000000 		.space	8
 233      00000000 
 234              		.text
 235              	.Letext0:
 236              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
 237              		.file 3 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xb.h"
 238              		.file 4 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_def.h"
 239              		.file 5 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_dma.h"
 240              		.file 6 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_spi.h"
 241              		.file 7 "Middlewares/Third_Party/FreeRTOS/Source/portable/GCC/ARM_CM3/portmacro.h"
 242              		.file 8 "Middlewares/Third_Party/FreeRTOS/Source/include/FreeRTOS.h"
 243              		.file 9 "Middlewares/Third_Party/FreeRTOS/Source/include/queue.h"
 244              		.file 10 "Middlewares/Third_Party/FreeRTOS/Source/include/semphr.h"
 245              		.file 11 "Middlewares/Third_Party/FreeRTOS/Source/CMSIS_RTOS/cmsis_os.h"
 246              		.file 12 "./src/gpio.h"
 247              		.file 13 "./src/spi.h"
 248              		.file 14 "<built-in>"
ARM GAS  /tmp/cc2NIaC5.s 			page 6


DEFINED SYMBOLS
                            *ABS*:0000000000000000 spi.c
     /tmp/cc2NIaC5.s:16     .text.spi_init:0000000000000000 $t
     /tmp/cc2NIaC5.s:24     .text.spi_init:0000000000000000 spi_init
     /tmp/cc2NIaC5.s:55     .text.spi_init:0000000000000010 $d
     /tmp/cc2NIaC5.s:60     .text.spi_ss_on:0000000000000000 $t
     /tmp/cc2NIaC5.s:67     .text.spi_ss_on:0000000000000000 spi_ss_on
     /tmp/cc2NIaC5.s:89     .text.spi_ss_off:0000000000000000 $t
     /tmp/cc2NIaC5.s:96     .text.spi_ss_off:0000000000000000 spi_ss_off
     /tmp/cc2NIaC5.s:118    .text.spi_read:0000000000000000 $t
     /tmp/cc2NIaC5.s:125    .text.spi_read:0000000000000000 spi_read
     /tmp/cc2NIaC5.s:175    .text.spi_write:0000000000000000 $t
     /tmp/cc2NIaC5.s:182    .text.spi_write:0000000000000000 spi_write
     /tmp/cc2NIaC5.s:232    .rodata.os_mutex_def_spi_mutex:0000000000000000 os_mutex_def_spi_mutex
     /tmp/cc2NIaC5.s:228    .rodata.os_mutex_def_spi_mutex:0000000000000000 $d

UNDEFINED SYMBOLS
osMutexCreate
gpio_set
gpio_reset
memset
osMutexWait
HAL_SPI_Receive
osMutexRelease
HAL_SPI_Transmit
